<tal:block define="mode options/mode;
  id here/getWidgetId;
  value_name here/getHtmlWidgetId;
  value options/value;
  rposition options/render_position;
  rformat options/render_format;
  configurable options/configurable;
  ">
  <tal:block condition="python: mode == 'view'">
    <div tal:attributes="class python:test(rposition == 'col_left', 'dcolleft',
      test(rposition == 'col_right',
      'dcolright', 'ddefault'))"
      tal:content="structure value" />
  </tal:block>
  <tal:block condition="python: mode == 'edit'">
    <div>
      <textarea tal:attributes="id value_name;
        name value_name;
        cols here/width;
        rows here/height;"
        tal:content="value" />
    </div>

    <div>
      <tal:block condition="python: configurable.find('position')>=0">
        <span i18n:translate="">cpsschemas_render_position</span>
        <select tal:attributes="name string:${value_name}_rposition">
          <option tal:repeat="op here/all_render_positions"
            tal:attributes="selected python:op == rposition;
            value op"
            tal:content="string:cpsschemas_rposition_${op}" i18n:translate="" />
        </select>
      </tal:block>

      <tal:block condition="python: configurable.find('format')>=0"
        define="button_rte_id python:'widget__%s_button' % id"
        >
        <span i18n:translate="">cpsschemas_render_format</span>
        <select tal:attributes="name string:${value_name}_rformat;
          onchange python:'toggleElementVisibility(\'%s\')' % button_rte_id
          ">
          <option tal:repeat="op here/all_render_formats"
            tal:attributes="selected python:op == rformat;
            value op"
            tal:content="string:cpsschemas_rformat_${op}" i18n:translate="" />
        </select>
        <button type="button"
          i18n:translate="button_rte"
          tal:condition="python:rformat=='html' or configurable.find('format')>=0"
          tal:attributes="
          id button_rte_id;
          style python:test(rformat == 'html',
          'visibility: visible;;', 'visibility: hidden;;');
          onclick
          string:javascript:popup_rte('${value_name}', '${here/label_edit}')
          "
          >Layout</button>
      </tal:block>
    </div>

  </tal:block>
</tal:block>
