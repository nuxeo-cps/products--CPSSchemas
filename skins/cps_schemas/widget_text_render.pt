<tal:block define="mode options/mode;
  id here/getWidgetId;
  value_name here/getHtmlWidgetId;
  value options/value;
  file_uploader here/file_uploader;
  rposition options/render_position;
  rformat options/render_format;
  configurable options/configurable;
  button_text_editor_popup_id python:'widget__%s_button' % id;
  file_upload_id python:'widget__%s_fileupload' % id;
  ">
  <tal:block condition="python: mode == 'view'">
    <div tal:condition="value"
      tal:attributes="class python:test(rposition == 'col_left', 'dcolleft',
      test(rposition == 'col_right',
      'dcolright', 'ddefault'))"
      tal:content="structure value" />
  </tal:block>
  <tal:block condition="python: mode == 'edit'">
      <textarea tal:attributes="id value_name;
        name value_name;
        cols here/width;
        rows here/height;"
        tal:content="value" />
    <p>
      <tal:block condition="python: configurable.find('position') >= 0">
        <tal:block i18n:translate="">cpsschemas_render_position</tal:block>
        <select tal:attributes="name string:${value_name}_rposition">
          <option tal:repeat="op here/all_render_positions"
            tal:attributes="selected python:op == rposition;
            value op"
            tal:content="string:cpsschemas_rposition_${op}" i18n:translate="" />
        </select>
      </tal:block>

      <tal:block condition="python: configurable.find('format') >= 0">
        <tal:block i18n:translate="">cpsschemas_render_format</tal:block>
        <select tal:attributes="name string:${value_name}_rformat;
          id string:${value_name}_rformat;
          onchange python:'showElement(this.value == \'html\',\'%s\')' % button_text_editor_popup_id
          ">
          <option tal:repeat="op here/all_render_formats"
            tal:attributes="selected python:op == rformat;
            value op"
            tal:content="string:cpsschemas_rformat_${op}" i18n:translate="" />
        </select>
      </tal:block>
      <button type="button"
        i18n:translate="button_text_editor_popup"
        tal:attributes="
        id button_text_editor_popup_id;
        style python:test(rformat == 'html',
        'visibility: visible;;', 'visibility: hidden;;');
        onclick
        string:javascript:popup_rte('${value_name}', '${here/label_edit}')
        "
        >Layout</button>
      <tal:block condition="file_uploader">
        <input type="file" tal:attributes="name file_upload_id"/>
      </tal:block>
    </p>

  </tal:block>
</tal:block>
