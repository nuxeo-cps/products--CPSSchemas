<tal:block define="layout options/layout;
                   ds options/datastructure;
                   dm options/datamodel;
                  ">
<form action="." method="POST" enctype="multipart/form-data"
  tal:attributes="action string:${here/absolute_url}/cpsdocument_editlayout">
<input type="hidden" name="layout_id" value="."
  tal:attributes="value layout/id">
<table border="1"
  tal:define="ncols layout/ncols">
  <tr tal:repeat="row layout/rows">
    <td>
      <input type="submit" name="." value="Monter"
        tal:attributes="name string:uprow_${repeat/row/index}"
        />
      <input type="submit" name="." value="Descendre"
        tal:attributes="name string:downrow_${repeat/row/index}"
        />
      <input type="submit" name="." value="Supprimer"
        tal:attributes="name string:deleterow_${repeat/row/index}"
        />
    </td>
    <td tal:repeat="cell row" tal:attributes="colspan cell/ncols">
      <tal:block define="widget cell/widget; wid widget/getWidgetId">
        <div tal:define="err python:ds.getError(wid)"
             tal:condition="err">
          <b style="color: red" tal:content="err">err</b>
        </div>
        <span tal:replace="widget/title">label</span>:
        <div tal:replace="structure python:widget.render('view', ds, dm)" />
      </tal:block>
    </td>
  </tr>
</table>
Ajouter:
<select name="widget_type">
  <option value="."
    tal:repeat="wtid here/portal_widgets/objectIds"
    tal:attributes="value wtid"
    tal:content="wtid">Type</option>
</select>
<input type="submit" name="addwidget_button" value="Ajouter" />
</form>
</tal:block>
